매크로 엔진 + PyQt6 GUI (액션 트리 / 조건 / 픽셀겟 / 라벨 점프)
============================================================

이 프로젝트는 Interception 기반 키/픽셀 매크로 엔진과 PyQt6 GUI 편집기입니다.  
모든 동작은 “액션 트리” 하나로 표현하며, 조건·반복·점프·픽셀 읽기까지 순차적으로 배치합니다. 기본/조건 탭은 없으며, 액션을 원하는 순서로 늘어놓고 드래그앤드롭으로 재배치합니다.

주요 특징
---------
- 단일 액션 트리: `press/down/up/sleep/if/label/goto/return/continue/break/group/while/pixel_get` 등.
- 조건: 키/픽셀, 중첩 AND/OR, on_true/on_false 브랜치. 색상/영역 변수 참조 지원(`/var`, `${var}`, `@var`).
- 픽셀겟: 화면 픽셀을 읽어 전역 color 변수에 저장 → 이후 조건에서 색상 변수로 사용.
- 흐름 제어: 라벨/점프, 그룹 모드(모두 실행, 첫 참만 실행, 첫 참 후 continue/return, 지정 횟수 반복, 무한 반복 while+break).
- 사이클 횟수: 매크로별 반복 횟수 설정(비우면 무한).
- 변수 시스템: sleep/region/color 전역 변수, 자동완성, 픽셀겟 시 새 color 변수 자동 추가 옵션.
- UI: 트리 드래그앤드롭, IF의 ELSE 브랜치는 필요할 때만 추가/제거 버튼으로 생성.
- 매크로 복제: 목록 하단 `복제` 버튼 또는 테이블 우클릭 메뉴로 선택 매크로를 전체 액션 트리/설정 그대로 복제. 기본 이름은 `원본이름 복사본`(중복 시 `... 복사본 2`), 저장 JSON에도 같은 형태로 추가됩니다.
- 글로벌 핫키: Home(활성), Insert(일시정지/재개), End(엔진 종료), PageUp(픽셀 테스트).

설치
----
```
uv sync
```

실행
----
```
uv run python main.py
```
Windows + 관리자 권한 필요(Interception 드라이버 사용).

액션 타입 요약
--------------
- `press/down/up`: 키 입력.
- `sleep`: ms 또는 범위 `1000~1500`.
- `timer`: 타이머1~20 슬롯을 지정 초 값(정수/소수, 예: 0.1)으로 초기화(예: 타이머1=0). 설정 이후 실시간으로 1초씩 자동 증가.
- `if`: 조건이 참이면 children, 거짓이면 ELSE children 실행(ELSE는 필요할 때만 추가).
- `label` / `goto`: 흐름 점프.
- `return`: 현재 매크로 종료.
- `continue`: 매크로 사이클 처음으로.
- `break`: 현재 그룹/while 루프 탈출.
- `group`: children 실행. 그룹 모드:
  - `all`(기본): 모두 실행
  - `first_true`: 조건 히트 시 그룹 종료
  - `first_true_continue`: 조건 히트 시 매크로 사이클 처음으로
  - `first_true_return`: 조건 히트 시 매크로 종료
  - `while`: break를 만날 때까지 children을 무한 반복(루프 내부에 sleep 넣어 조절)
  - `repeat_n`: 지정한 횟수만큼 children 실행(continue=다음 반복, break=즉시 종료)
- `pixel_get`: 좌표(x,y 또는 region 변수)에서 한 픽셀 색을 읽어 color 변수에 저장. w/h를 입력해도 1x1로 처리. 없는 변수면 추가 여부 확인.
- `noop`: 활성 off 등 자리를 유지할 때 사용.

조건
----
- 키/마우스: `press/down/up/hold/released` (mouse1~5 포함).
- 픽셀: 영역/색상/허용오차, “있을 때 참” 또는 “없을 때 참”.
- 타이머: 슬롯(1~20)과 비교값(초, 소수 가능), 비교 방식(>=, >, ==, <=, <, !=).
- 색상 입력: 16진수(`ff0000`) 또는 변수(`/momo`). 변수는 런타임에 해석되며 값이 비어 있으면 조건은 실패(false).
- 영역 입력: `x,y` 또는 `x,y,w,h` (w,h를 생략하면 1x1).

변수(전역)
----------
- 종류: `sleep`, `region`, `color`.
- 참조: `/name`, `${name}`, `@name`.
- UI 탭에서 추가/수정, 입력란에서 `/`를 치면 자동완성.
- 픽셀겟에서 새 color 변수를 입력하면 추가 여부 팝업(Yes 시 기본값 000000으로 등록).

흐름 제어 예시
-------------
- “조건이 참이면 처음으로”: IF 안에 조건 + THEN에 `goto`/`label` 또는 그룹 모드 `first_true_continue`.
- “조건이 참이면 종료”: 그룹 모드 `first_true_return` 또는 THEN에 `return`.
- “N회만 실행”: 그룹 모드 `repeat_n` + 반복 횟수 지정.
- “무한 반복 루프”: 그룹 모드 `while` + 내부에 `break` 조건.

기본 예시 매크로
----------------
- 트리거 z(hold): `r` → `sleep 50` → `t` → `if(pixel) ? f1 : f2` 반복.

사용 팁
-------
- 딜레이가 필요 없는 곳엔 `sleep`을 넣지 않음. 그룹 `while` 내부는 틱 슬립 없이 최대 속도로 반복하므로 필요 시 `sleep`을 끼워 넣어 CPU 사용을 조절하세요.
- ELSE가 필요 없으면 추가하지 않아도 됩니다. 필요 시 `ELSE 추가` 버튼으로 생성, `ELSE 제거`로 삭제.

알려진 요구사항
--------------
- Windows, 관리자 권한 실행.
- Interception 드라이버 설치 필수(키 입력/차단 기능용).
